---
title: "R Notebook"
output: html_notebook
---

1. Формулировка гипотез
- Нулевая гипотеза (H0): Новый препарат не изменяет среднее артериальное давление по сравнению со стандартной терапией. Это означает, что различия между средним артериальным давлением до и после приема нового препарата отсутствуют или незначительны.
- Альтернативная гипотеза (H1): Новый препарат в среднем лучше снижает артериальное давление по сравнению со стандартной терапией. Это означает, что существует статистически значимое уменьшение среднего артериального давления после применения нового препарата.
-
2. Уровень значимости
Уровень значимости α=0.05 -> мы готовы принять до 5% риск ошибочного отклонения нулевой гипотезы, когда она на самом деле верна.

3. Выбор статистического теста
Для проверки гипотезы о средних двух зависимых выборок (до и после введения препарата) лучше всего использовать t-тест для зависимых выборок, так как одни и те же пациенты наблюдались до и после введения препарата.

4. Определение наблюдаемого и критического значения статистики
Мы предположим, что среднее артериальное давление пациентов до приема нового препарата составляет 140 мм рт. ст., а стандартное отклонение – 20 мм рт. ст. После приема препарата среднее давление уменьшилось до 130 мм рт. ст., со стандартным отклонением 18 мм рт. ст.

Полученное наблюдаемое значение t-статистики составляет примерно 2.1, а p-значение — 0.03.

5. Оценка и комментарии к статистической значимости
Поскольку p-значение (0.03) меньше установленного уровня значимости (0.05), мы можем отвергнуть нулевую гипотезу на уровне значимости 5%. Это означает, что на основании полученных данных можно утверждать, что новый препарат лучше снижает артериальное давление по сравнению со стандартной терапией.

The code chunk appears:
```{r}
# Установим seed для воспроизводимости результатов
set.seed(42)

# Задаем размер выборки
sample_size <- 30

# Генерируем данные до и после введения препарата
# Предполагаем, что данные распределены нормально
mean_before <- 140
std_before <- 20
mean_after <- 130
std_after <- 18

blood_pressure_before <- rnorm(sample_size, mean_before, std_before)
blood_pressure_after <- rnorm(sample_size, mean_after, std_after)

# Проведем t-тест для зависимых выборок
t_test_result <- t.test(blood_pressure_before, blood_pressure_after, paired = TRUE)

# Выводим значение t-статистики и p-value
t_test_result
```

Формулировка гипотез
- Нулевая гипотеза (H0): Нет связи между курением и развитием рака легких. Разница в вероятности развития рака легких между курящими и некурящими не является статистически значимой.
- Альтернативная гипотеза (H1): Существует связь между курением и развитием рака легких. Вероятность развития рака легких у курящих значимо отличается от вероятности у некурящих.

Уровень значимости
Выберем стандартный уровень значимости α=0.05.

Выбор статистического теста
Для анализа данных, которые представляют собой вероятности заболевания в двух группах (курящие и некурящие), подходит z-тест для двух пропорций, так как он позволяет сравнить доли успехов в двух независимых выборках и определить, есть ли статистически значимые различия между ними.

Оценка статистической значимости
Оценка будет проведена на основании p-значения, полученного из z-теста. Если p-значение меньше уровня значимости (p<α), мы отвергаем нулевую гипотезу в пользу альтернативной, заключая, что есть статистически значимая связь между курением и развитием рака легких.

Результаты z-теста для двух пропорций в наших сгенерированных данных показывают следующее:

- Для выборки размером 100: z-статистика: 36, p-значение: 1.97×10^(−9)
- Для выборки размером 30: z-статистика: 10.8, p-значение: 0.001

Оценка и комментарии к статистической значимости
В обоих случаях p-значение намного меньше установленного уровня значимости (α=0.05), что позволяет нам отвергнуть нулевую гипотезу -> существует статистически значимая связь между курением и развитием рака легких.

В выборке из 100 наблюдений статистическая значимость выше, что подчеркивает более сильную связь между курением и раком легких при больших объемах выборки.
В выборке из 30 наблюдений результаты также показывают статистическую значимость, подтверждая гипотезу о связи курения с раком легких, хотя и с меньшей степенью уверенности по сравнению с большей выборкой.
```{r}
# Установим seed для воспроизводимости результатов
set.seed(42)

# Определяем функцию для проведения z-теста для двух пропорций
run_prop_test <- function(sample_size, prob_smoking, prob_nonsmoking) {
  # Размеры подгрупп
  group_size <- sample_size / 2

  # Количество случаев рака среди курящих и некурящих
  cases_smoking <- round(prob_smoking * group_size)
  cases_nonsmoking <- round(prob_nonsmoking * group_size)

  # Использование prop.test для сравнения двух пропорций
  test_result <- prop.test(c(cases_smoking, cases_nonsmoking),
                           c(group_size, group_size),
                           correct = FALSE) # Используем параметр correct = FALSE для z-теста

  return(test_result)
}

# Параметры для теста
prob_smoking <- 0.8
prob_nonsmoking <- 0.2
sample_sizes <- c(100, 30)

# Проведение тестов для разных размеров выборки
for (sample_size in sample_sizes) {
  test_result <- run_prop_test(sample_size, prob_smoking, prob_nonsmoking)
  print(paste("Sample size:", sample_size))
  print(test_result)
}
```


Формулировка гипотез
- Нулевая гипотеза (H0): Применение нового метода лечения не имеет статистически значимого влияния на уровень болевых симптомов по сравнению с диетотерапией. То есть, различия в уровне болевых симптомов между группами не значительны.
- Альтернативная гипотеза (H1): Новый метод лечения синдрома раздраженного кишечника значимо меняет уровень болевых симптомов по сравнению с группой, прошедшей лечение диетотерапией.

Уровень значимости
Уровень значимости α=0.05.

Выбор статистического теста
Тест Манна-Уитни (или U-тест) является подходящим выбором для сравнения двух независимых выборок, когда нет предположений о нормальности распределения данных. Этот тест оценивает, отличаются ли распределения двух групп.

Генерация данных и проведение теста
Предположим, что уровни болевых симптомов измеряются по шкале от 0 до 10, где 0 означает отсутствие боли, а 10 - максимально возможную боль.

Оценка статистической значимости
Результаты теста будут включать U-статистику и p-значение, которое поможет определить, есть ли статистически значимые различия между группами. Если p-значение меньше установленного уровня значимости (α=0.05), мы отвергаем нулевую гипотезу, подтверждая, что методы лечения оказывают различное влияние на уровень болевых симптомов.

Проведем анализ с использованием Python:
Полученное значение U-статистики составляет 82.0, а p-значение — примерно 2.4×10^(−9).

Оценка и комментарии к статистической значимости
P-значение значительно меньше уровня значимости α=0.05, что позволяет нам отвергнуть нулевую гипотезу. Это указывает на то, что существует статистически значимое различие в уровнях болевых симптомов между группой, получавшей новое лечение, и группой, прошедшей диетотерапию.
```{r}
# Установка seed для воспроизводимости
set.seed(42)

# Генерация имитационных данных
group_new_treatment <- runif(30, min = 0, max = 5) # Новое лечение, более низкие уровни боли
group_diet_therapy <- runif(30, min = 3, max = 10) # Диетотерапия, более высокие уровни боли

# Проведение теста Манна-Уитни
test_result <- wilcox.test(group_new_treatment, group_diet_therapy, alternative = "two.sided")

# Вывод результатов
test_result

```

Данный код позволит оценить распределение размеров опухолей в каждой из трех групп.
```{r}
library(tibble)
library(ggplot2)
library(dplyr)

# Генерация датасета
tumor <- tibble(
  therapy = c(rep("0", 10), rep("A", 10), rep("B", 10)),
  value = c(rep(3213, 10), rep(2687, 10), rep(2423, 10))
) %>%
  mutate(therapy = factor(therapy, levels = c("0", "A", "B")))

# Добавление случайного шума к значениям размера опухоли
set.seed(42) # для воспроизводимости
tumor$value <- tumor$value + rnorm(30, 0, 760)

# Визуализация с помощью "ящиков с усами"
ggplot(tumor, aes(x = therapy, y = value, fill = therapy)) +
  geom_boxplot() +
  labs(title = "Размер опухоли по группам терапии", x = "Группа терапии", y = "Размер опухоли") +
  theme_minimal()
```

Для оценки различий между группами проведем дисперсионный анализ (ANOVA).
Этот анализ покажет, есть ли статистически значимые различия в средних размерах опухолей между группами.
```{r}
# Дисперсионный анализ
anova_result <- aov(value ~ therapy, data = tumor)
summary(anova_result)
```

Используем критерий Тьюки для попарного сравнения групп.
```{r}
# Попарные сравнения с использованием критерия Тьюки
tukey_result <- TukeyHSD(anova_result)
tukey_result
```

Дисперсионный анализ позволяет оценить, есть ли в целом статистически значимые различия между группами. Если p-значение меньше выбранного уровня значимости (обычно 0.05), это указывает на то, что хотя бы одна группа значимо отличается от других.
